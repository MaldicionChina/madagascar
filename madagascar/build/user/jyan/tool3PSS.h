/* This file is automatically generated. DO NOT EDIT! */

#ifndef _tool3PSS_h
#define _tool3PSS_h


#define  MAX2(a,b)   a>b? a: b
#define  MAX(a,b,c)  MAX2(a,b) >c ? MAX2(a,b) :c
/*------------------------------------------------------------*/
/*2D*/
typedef struct wfs *wfs2d;


wfs2d wfsep_init(sf_axis  ax,
		 sf_axis  az);
/*< init wavefield separator >*/


/*------------------------------------------------------------*/
/*3D*/
typedef struct wfs3 *wfs3d;


struct wfs3{   
    sf_complex ***temp;
    float        *eigv; /* eigenvalues */
    float       **ctfl; /* Christoffel matrix */ 
    float          *up;/*eigenvectors */
    float       ***upx,***upy,***upz;
    sf_fft3d          ftx,fty,ftz;
};
/*^*/
    
wfs3d wfsep3_init(sf_axis  ax,
		  sf_axis  ay,
		  sf_axis  az);
/*< init wavefield separator >*/


void wfsep3_close(wfs3d wfs3);
/*< close wavefield separator >*/


/*------------------------------------------------------------*/
/*Program  to calculate eigenvectors and eigenvalues*/
void wfsepK3(float ***pxdel, float ***pydel, float *** pzdel,
	     float ***vxdel, float ***vydel, float *** vzdel,
	     float ***hxdel, float ***hydel, float *** hzdel,	     
	     sf_axis  ax,
	     sf_axis  ay,
	     sf_axis  az,
	     float   c11,
	     float   c12,
	     float   c13,
	     float   c22,
	     float   c23,
	     float   c33,
	     float   c44,
	     float   c55,
	     float   c66,
	     wfs3d   wfs3
    );
/*<test>*/


/*------------------------------------------------------------*/
void wfsep3(float ***pxdel, float ***pydel, float *** pzdel,
	    float ***vxdel, float ***vydel, float *** vzdel,
	    float ***hxdel, float ***hydel, float *** hzdel,	     
	    sf_axis  ax,
	    sf_axis  ay,
	    sf_axis  az,
	    float   c11,
	    float   c12,
	    float   c13,
	    float   c22,
	    float   c23,
	    float   c33,
	    float   c44,
	    float   c55,
	    float   c66,
	    wfs3d   wfs3
    );
/*<test>*/

#endif
